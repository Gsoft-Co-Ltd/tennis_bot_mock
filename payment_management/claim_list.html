<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>請求情報一覧</title>
  <!-- Bootstrap 5 CSS -->
  <link
    href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css"
    rel="stylesheet"
  />
  <!-- Font Awesome (必要に応じて) -->
  <link
    href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css"
    rel="stylesheet"
  />
  <style>
    /* ベーススタイル */
    body {
      background-color: #f5f7fa;
      font-family: "Noto Sans JP", sans-serif; /* 他画面と統一 */
      margin: 0;
      padding: 20px;
    }
    .container {
      max-width: 1100px;
      margin: 0 auto;
    }
    h3 {
      font-weight: 700;
      margin-bottom: 24px;
    }

    /* .card & .card-body はスクール生一覧と同じ定義 */
    .card {
      margin-bottom: 10px;
      border-radius: 8px;
      box-shadow: 0 2px 5px rgba(0,0,0,0.1);
      background: #fff;
      border: none;
    }
    .card-body {
      padding: 15px;
    }
    /* card-headerは特に背景色を付けない (デフォルト or 白)  */
    .card-header {
      /* Bootstrap標準で少し薄いグレー背景になりますが、
         それも消したいなら下記を入れて白にしてもOK:
         background: #fff;
         border-bottom: none; */
      border-top-left-radius: 8px;
      border-top-right-radius: 8px;
      font-weight: bold;
      padding: 10px 15px;
    }

    /* テーブルの外枠（.table-wrap） */
    .table-wrap {
      background: #fff;
      border-radius: 8px;
      overflow: hidden;
      box-shadow: 0 2px 5px rgba(0,0,0,0.1);
      margin-bottom: 20px;
    }
    table thead th {
      background-color: #007bff;
      color: #fff;
      position: sticky;
      top: 0;
      z-index: 10;
      white-space: nowrap;
    }
    table tbody tr:nth-child(odd) {
      background-color: #f9f9f9;
    }

    /* ボタン色: 追加=青, 編集=黄, 削除=赤
       (スクール生一覧でのポリシーを踏襲) */
    .btn-edit {
      background-color: #ffc107; /* 黄色系 */
      color: #212529;
    }
    .btn-edit:hover {
      background-color: #e0a800;
      color: #212529;
    }
    .btn-delete {
      background: #dc3545;
      color: #fff;
    }
    .btn-delete:hover {
      background: #c82333;
    }

    /* 支払い状況ボタン(在籍ステータスと同様の色分けイメージ) */
    .btn-before-request {
      background-color: #e2e3e5;
      color: #6c757d;
    }
    .btn-paid {
      background-color: #d4edda;
      color: #155724;
    }
    .btn-failed {
      background-color: #f8d7da;
      color: #721c24;
    }
  </style>
</head>
<body>
<div class="container">
  <!-- タイトル -->
  <h3>請求情報一覧</h3>

  <!-- ▼▼▼ 企業・スクール選択カード ▼▼▼ -->
  <div class="card mb-3">
    <div class="card-body">
      <div class="row align-items-end gx-2">
        <!-- 企業選択 -->
        <div class="col-auto">
          <label for="companySelect" class="form-label mb-0 fw-bold">企業</label>
          <select id="companySelect" class="form-select form-select-sm">
            <option value="companyA" selected>株式会社A</option>
            <option value="companyB">株式会社B</option>
            <option value="companyC">株式会社C</option>
          </select>
        </div>
        <!-- スクール選択 -->
        <div class="col-auto">
          <label for="schoolSelect" class="form-label mb-0 fw-bold">スクール</label>
          <select id="schoolSelect" class="form-select form-select-sm">
            <option value="schoolX" selected>東京スクール</option>
            <option value="schoolY">大阪スクール</option>
            <option value="schoolZ">福岡スクール</option>
          </select>
        </div>
        <!-- 選択ボタン -->
        <div class="col-auto">
          <button id="selectButton" class="btn btn-primary btn-sm">選択</button>
        </div>
      </div>
    </div>
  </div>

  <!-- ▼▼▼ 2カラム: 左 = 請求情報追加 / 右 = 検索・フィルタ ▼▼▼ -->
  <div class="row mb-3">
    <!-- 請求情報追加カード -->
    <div class="col-lg-6">
      <div class="card">
        <div class="card-header">請求情報追加</div>
        <div class="card-body">
          <form id="addBillingForm" class="row g-3">
            <div class="col-md-6">
              <label for="memberName" class="form-label fw-bold">会員名</label>
              <select id="memberName" class="form-select" required>
                <option value="" disabled selected>選択</option>
                <option value="山田 太郎">山田 太郎</option>
                <option value="佐藤 花子">佐藤 花子</option>
              </select>
            </div>
            <div class="col-md-6">
              <label for="originalAmount" class="form-label fw-bold">元金額</label>
              <input type="number" id="originalAmount" class="form-control" required />
            </div>
            <div class="col-md-6">
              <label for="billingDate" class="form-label fw-bold">請求日</label>
              <input type="date" id="billingDate" class="form-control" required />
            </div>
            <div class="col-md-6">
              <label for="paymentStatus" class="form-label fw-bold">支払い状況</label>
              <select id="paymentStatus" class="form-select" required>
                <option value="引落依頼前">引落依頼前</option>
                <option value="支払い済み">支払い済み</option>
                <option value="引落失敗">引落失敗</option>
                <option value="未払い">未払い</option>
              </select>
            </div>
            <div class="col-12">
              <label for="billingCategory" class="form-label fw-bold">請求内容</label>
              <input
                type="text"
                id="billingCategory"
                class="form-control"
                placeholder="例: レッスン費"
              />
            </div>
            <div class="col-12 text-end">
              <button type="submit" class="btn btn-primary">
                <i class="fas fa-plus"></i> 追加
              </button>
            </div>
          </form>
        </div>
      </div>
    </div>

    <!-- 検索・フィルタカード -->
    <div class="col-lg-6">
      <div class="card">
        <div class="card-header">検索・フィルタ</div>
        <div class="card-body">
          <div class="row g-3 align-items-end">
            <!-- 年 -->
            <div class="col-auto">
              <label for="yearSelect" class="form-label fw-bold mb-0">年</label>
              <select id="yearSelect" class="form-select form-select-sm" style="width:80px;">
                <option value="2024" selected>2024</option>
                <option value="2025">2025</option>
              </select>
            </div>
            <!-- 月 -->
            <div class="col-auto">
              <label for="monthSelect" class="form-label fw-bold mb-0">月</label>
              <select id="monthSelect" class="form-select form-select-sm" style="width:80px;">
                <option value="01">1</option>
                <option value="02">2</option>
                <!-- ... -->
                <option value="11" selected>11</option>
                <option value="12">12</option>
              </select>
            </div>
            <!-- 会員名検索 -->
            <div class="col-auto">
              <label for="searchInput" class="form-label fw-bold mb-0">会員名</label>
              <input
                type="text"
                id="searchInput"
                class="form-control form-control-sm"
                placeholder="名前で検索"
                style="width: 150px;"
              />
            </div>
            <!-- 引落失敗のみ -->
            <div class="col-auto">
              <div class="form-check">
                <input class="form-check-input" type="checkbox" id="failedOnly" />
                <label class="form-check-label" for="failedOnly">引落失敗のみ</label>
              </div>
            </div>
            <!-- 出力 & インポートボタン -->
            <div class="col-auto">
              <button class="btn btn-success btn-sm">
                <i class="fas fa-file-excel"></i> 出力
              </button>
              <button class="btn btn-warning btn-sm" id="excelImportButton">
                <i class="fas fa-file-import"></i> インポート
              </button>
            </div>
          </div> <!-- row -->
        </div>
      </div>
    </div>
  </div>

  <!-- ▼▼▼ 請求一覧テーブル ▼▼▼ -->
  <div class="table-wrap">
    <table class="table table-striped table-hover mb-0" id="billingTable">
      <thead>
        <tr>
          <th scope="col">請求ID</th>
          <th scope="col">会員名</th>
          <th scope="col">元金額</th>
          <th scope="col">最終請求額（税込）</th>
          <th scope="col">請求日</th>
          <th scope="col">支払い状況</th>
          <th scope="col">請求内容</th>
          <th scope="col">操作</th>
        </tr>
      </thead>
      <tbody>
        <!-- サンプルデータ (カラム削減済み) -->
        <tr>
          <td>1001</td>
          <td class="text-primary" style="cursor:pointer; text-decoration:underline;">山田 太郎</td>
          <td>¥12,000</td>
          <td>¥13,200</td>
          <td>2024/09/01</td>
          <td><button class="btn btn-paid btn-sm">支払い済み</button></td>
          <td>レッスン費</td>
          <td>
            <button class="btn btn-sm btn-edit">編集</button>
            <button class="btn btn-sm btn-delete">削除</button>
          </td>
        </tr>
        <tr>
          <td>1002</td>
          <td class="text-primary" style="cursor:pointer; text-decoration:underline;">佐藤 花子</td>
          <td>¥15,000</td>
          <td>¥16,500</td>
          <td>2024/09/15</td>
          <td><button class="btn btn-failed btn-sm">引落失敗</button></td>
          <td>ラケット費</td>
          <td>
            <button class="btn btn-sm btn-edit">編集</button>
            <button class="btn btn-sm btn-delete">削除</button>
          </td>
        </tr>
      </tbody>
    </table>
  </div>
</div>

<!-- Bootstrap JS (Popper含む) -->
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
<script>
  // ▼▼▼ 企業スクール選択 (モック) ▼▼▼
  document.getElementById("selectButton").addEventListener("click", () => {
    const company = document.getElementById("companySelect").value;
    const school  = document.getElementById("schoolSelect").value;
    alert(`企業: ${company}, スクール: ${school} を選択しました(モック)`);
  });

  // ▼▼▼ 「請求情報追加」フォーム送信 ▼▼▼
  document.getElementById("addBillingForm").addEventListener("submit", function(e) {
    e.preventDefault();
    const memberName = document.getElementById("memberName").value;
    const originalAmount = parseInt(document.getElementById("originalAmount").value, 10) || 0;
    const billingDate = document.getElementById("billingDate").value;
    const paymentStatus = document.getElementById("paymentStatus").value;
    const category = document.getElementById("billingCategory").value.trim() || "未入力";
    // 最終請求額 (例: 10%加算)
    const finalAmount = Math.floor(originalAmount * 1.1);
    const newId = Math.floor(Math.random() * 100000);

    addRowToTable({
      billingId: newId,
      memberName,
      originalAmount,
      finalAmount,
      billingDate,
      paymentStatus,
      category
    });
    alert("請求情報を追加しました（モック）");
    this.reset();
  });

  // ▼▼▼ テーブルに行を追加 (モック) ▼▼▼
  function addRowToTable(data) {
    const tableBody = document.querySelector("#billingTable tbody");
    const tr = document.createElement("tr");
    // 支払い状況ボタンの色
    let statusClass = "btn-before-request";
    if (data.paymentStatus === "支払い済み") {
      statusClass = "btn-paid";
    } else if (data.paymentStatus === "引落失敗") {
      statusClass = "btn-failed";
    }

    tr.innerHTML = `
      <td>${data.billingId}</td>
      <td class="text-primary" style="cursor:pointer; text-decoration:underline;">
        ${data.memberName}
      </td>
      <td>¥${data.originalAmount.toLocaleString()}</td>
      <td>¥${data.finalAmount.toLocaleString()}</td>
      <td>${data.billingDate}</td>
      <td><button class="btn btn-sm ${statusClass}">${data.paymentStatus}</button></td>
      <td>${data.category}</td>
      <td>
        <button class="btn btn-sm btn-edit">編集</button>
        <button class="btn btn-sm btn-delete">削除</button>
      </td>
    `;
    tableBody.appendChild(tr);

    // 編集・削除ボタン (モック)
    tr.querySelector(".btn-edit").addEventListener("click", () => {
      alert("編集機能はモックです。");
    });
    tr.querySelector(".btn-delete").addEventListener("click", () => {
      if (confirm("本当に削除しますか？（削除フラグ）")) {
        tr.remove();
      }
    });

    // 会員名クリックで詳細モック
    tr.querySelector(".text-primary").addEventListener("click", () => {
      alert(`${data.memberName} さんの詳細(モック)`);
    });
  }

  // ▼▼▼ 検索・フィルタはモック ▼▼▼
  document.getElementById("excelImportButton").addEventListener("click", function() {
    alert("Excelインポートはモックです。");
  });
  document.getElementById("searchInput").addEventListener("keyup", () => {
    alert("検索機能はモックです。");
  });
  document.getElementById("failedOnly").addEventListener("change", () => {
    alert("引落失敗のみ表示はモックです。");
  });
</script>
</body>
</html>
